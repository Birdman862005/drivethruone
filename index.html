<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drive Thru ONE</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>


<style>


body { margin:0; font-family: Arial; background:#1a1a1a; color:white; }
.screen { display:none; height:calc(100vh - 100px); }
.active { display:block; }

/* HEADER */
.header { display:flex; flex-wrap: wrap; align-items:center; padding:15px 5px; background:#111;}
.logo { margin-right: 10px; display: flex; font-style: italic; margin-top:5px}
.drive-thru { font-size: 30px; font-weight:bold; transform:rotate(0deg);font-family: Haffer, Haffer-fallback-1, Haffer-fallback-2, Helvetica, Arial, Fustat, sans-serif; }
.one { font-size: 30px; font-weight:bold; color:#ff9800; margin-top:1px; transform:rotate(0deg); margin-left: 10px;}
.logo, .drive, .one { margin-right:-20px;font-family: Haffer, Haffer-fallback-1, Haffer-fallback-2, Helvetica, Arial, Fustat, sans-serif;}
.search {  margin-left: 41px; margin-top:10px;}
.search input { width:80%; padding:5px 10px; font-size:22px; border-radius:4px; border:none;  }
.total-view { display:flex; align-items:center; margin-left:auto; flex-shrink:0; }
.total-view span { margin-right: 15px; }
.view-order { background:#ffcc00; color:black; padding:12px 12px; font-weight:bold; border:none; border-radius:4px; cursor:pointer; }

.redline { height:4px; background:red; margin-top:-2px}

/* CATEGORIES */
.categories {
  margin-top: 5px;
  margin-left: 10px;
  padding:20px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(80px,1fr));
  gap:25px;}
  
.cat-btn {
  aspect-ratio:1/1;
  border:none;
  border-radius:6px;
  color:white;
  font-weight:bold;
  cursor:pointer;
  font-size:22px;
}
/* Category Colors */
.drinks { background:#89CFF0; }   /* Blue */
.snacks { background:#FFD580; }   /* Orange */
.tobacco { background:#808080; }  /* Purple */
.beer { background:#765341; }     /* Green */
/* ITEMS */
#itemList { margin-top:13px;margin-left:20px;display:grid; grid-template-columns:repeat(auto-fill,minmax(90px,1fr)); gap:20px; padding:10px; padding-bottom:90px;}
.item { background:#333; width:90px; height: 130px;border-radius:6px; display:flex; flex-direction:column; align-items:center; justify-content:center;cursor:pointer; aspect-ratio:1/1; padding:6px; text-align:center;}
.item img { width:60px; height:60px; margin-top:18px;object-fit:cover; border-radius:4px; }

/* ORDER */
#orderScreen { padding:15px; padding-bottom:100px; overflow-y:auto;}
.order-row { display:flex; align-items:center; gap:10px; background:#222; padding:8px; border-radius:6px; margin-bottom:8px;}
.order-row img { width:80px; height:80px; object-fit:cover; border-radius:4px;}
.delete-btn { background:red; color:white; border:none; width:35px; height:35px; border-radius:6px;}
.order-name { flex:1;}
.subtotal-box { text-align:right; font-weight:bold; margin-top:10px;font-size: 20px;margin-top:15px;}

/* BUTTONS */
.button-bar { position:fixed; bottom:15px; right:15px; display:flex; gap:10px;}
.done-btn { background:#00c853; color:white; border:none; padding:15px 25px; border-radius:6px;}
.back-btn { background:#666; color:white; border:none; padding:15px 25px; border-radius:6px;}

/* QR */
.overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); justify-content:center; align-items:center;}
.qr-box {
  background: white;
  padding: 10px;
  border-radius: 10px;
  max-width: 190vw;
  max-height: 190vh;
  display: flex;
  justify-content: center;
  align-items: center;
}
#qrcode {
  width: 100%;
  height: 100%;
}
#screen1 .search {
  display: none;
}

</style>
</head>

<body>

<div class="header">
  <div class="logo">
    <div class="drive-thru">Drive Thru</div>
    <div class="one">ONE</div>
  </div>
  <div class="total-view">
    <span id="itemCount">0 items</span>
    <span id="totalAmount">$0.00</span>
    <button class="view-order" onclick="openOrderScreen()">VIEW ORDER</button>
  </div>
</div>
<div class="redline"></div>

<div id="screen1" class="screen active">
  <div class="categories">
  <button class="cat-btn drinks" onclick="openCategory('drinks')">Drinks</button>
  <button class="cat-btn snacks" onclick="openCategory('snacks')">Snacks</button>
  <button class="cat-btn tobacco" onclick="openCategory('tobacco')">Tobacco</button>
  <button class="cat-btn beer" onclick="openCategory('beer')">Beer</button>
</div>

</div>

<div id="screen2" class="screen">
    <div class="search"><input placeholder="Search item..."></div>
  <div id="itemList"></div>
  <div class="button-bar">
    <button class="done-btn" onclick="showQR()">DONE</button>
    <button class="back-btn" onclick="goHome()">BACK</button>

  </div>
</div>

<div id="screen3" class="screen">
  <div id="orderScreen"></div>
  <div class="button-bar">
    <button class="done-btn" onclick="showQR()">DONE</button>
    <button class="back-btn" onclick="goHome()">BACK</button>
  </div>
</div>

<div class="overlay" id="overlay" onclick="if(event.target.id==='overlay') closeQR()">
  <div class="qr-box"><div id="qrcode"></div></div>
</div>

<script>
  let currentCategory = null;
const menu={
  drinks:[{name:"Milk (1/2 gal) ",price:2.69 ,img:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTvyIvBSmqZSS_cshOrIsUUU6SdNix20jt7ww&s"},
          {name:"Milk (1 gal) ",price:5.38 ,img:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTrAyB7Y3YYvgL-wotqbeNretGN-rfXRaYu-w&s"},
          {name:"Cola (12 oz)",price:1.50,img:"https://source.unsplash.com/300x300/?cola,can"}
          {name:"Pepsi",price:1.50,img:"https://m.media-amazon.com/images/I/31KIQ3A9WnL._SY300_SX300_QL70_FMwebp_.jpg"},
          {name:"Gatorade ",price:1.08 ,img:"https://img-1.kwcdn.com/local-goods-image/2019505e2c8/73915dbf-89c5-404f-81c2-da7005bd4ec0_1500x1500.jpeg.format.jpg?imageView2/2/w/264/q/70/format/avif"},
          
          ],
  snacks:[{name:"Lays",price:1.50,img:"https://m.media-amazon.com/images/I/81Ui6bB1nJL._SX679_.jpg"},
          {name:"Rice Krispies (16pk)",price:6.98,img:"https://m.media-amazon.com/images/I/81aoI6+4DSL._SX569_.jpg"},
          {name:"Welchs Fruit Snacks",price:9.74,img:"https://encrypted-tbn2.gstatic.com/shopping?q=tbn:ANd9GcTDV3RR3hGkw-IFf7YTTtmSJI8mxJEl5N70VTvsU2ECQJ2TJ1w_TnybJuA7aWDfoXUyA9lScd-hF_EveR0JCIF4GOzc4REHRQ4AILxFb4Dh2v7vXRB6aaLFRT5sCUXbC_Z_9OHGBpY&usqp=CAc"},


          {name:"Doritos (party size)",price:4.50,img:"https://i.pinimg.com/1200x/ba/60/b7/ba60b7e24fb4a4a330aaa84e8a13a1d5.jpg"}],
  tobacco:[{name:"Marlboro (pack)",price:5.50,img:"https://encrypted-tbn3.gstatic.com/shopping?q=tbn:ANd9GcSaLZySU1x8KFD75xkqv_tpV2NLY5ql5ywlb6B6fGGMJgf0Hyh_Mf3us4-VEeIxiwd-jxwW54dB_totvRelsmp6w01UFuwM"}
  ],
  beer:[{name:"Bud Light (12 pk)",price:10.99,img:"https://luekensliquors.com/cdn/shop/files/bda38f2c517a6abc09e7978467c59dc42aebf3e6.jpg?v=1755768483&width=2200"}]
};

let order=[];

function switchScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function openCategory(cat){
  currentCategory = cat; // track selected category
  switchScreen("screen2");
  displayItems(menu[cat]); // display all items for that category
}
function displayItems(items){
  const list = document.getElementById("itemList");
  list.innerHTML = "";
  items.forEach(item => {
    const btn = document.createElement("div");
    btn.className = "item";
    btn.innerHTML = `<img src="${item.img}"><div>${item.name}</div><div>$${item.price.toFixed(2)}</div>`;
    btn.onclick = () => addToOrder(item);
    list.appendChild(btn);
  });
}
const searchInput = document.querySelector(".search input");
searchInput.addEventListener("input", () => {
  if (!currentCategory) return; // do nothing if no category is selected

  const query = searchInput.value.toLowerCase().trim();
  const filteredItems = menu[currentCategory].filter(item => 
    item.name.toLowerCase().includes(query)
  );

  displayItems(filteredItems.length ? filteredItems : menu[currentCategory]);
});


function addToOrder(item){
  const found=order.find(i=>i.name===item.name);
  if(found){found.qty++;} else{order.push({...item,qty:1});}
  updateHeaderTotals();
}

function updateHeaderTotals(){
  let subtotal=0,count=0;
  order.forEach(i=>{subtotal+=i.price*i.qty;count+=i.qty;});
  itemCount.innerText=count+" items";
  totalAmount.innerText="$"+subtotal.toFixed(2);
}

function openOrderScreen() {
  switchScreen("screen3");
  const os = document.getElementById("orderScreen");
  os.innerHTML = "";

  let subtotal = 0;
  let totalItems = 0;

  order.forEach((item, index) => {
    const total = item.price * item.qty;
    subtotal += total;
    totalItems += item.qty;

    const row = document.createElement("div");
    row.className = "order-row";
    row.innerHTML = `
      <button class="delete-btn" onclick="removeItem(${index})"> X </button>
      <img src="${item.img}">
      <div class="order-name">${item.name} (x${item.qty})</div>
      <div>$${total.toFixed(2)}</div>
    `;
    os.appendChild(row);
  });

  // Container for item count + subtotal
  const subtotalContainer = document.createElement("div");
  subtotalContainer.style.display = "flex";
  subtotalContainer.style.flexDirection = "column";
  subtotalContainer.style.alignItems = "flex-end";
  subtotalContainer.style.marginTop = "10px";
  subtotalContainer.style.marginRight = "15px";

  // Item count
  const itemCountDiv = document.createElement("div");
  itemCountDiv.style.fontWeight = "bold";
  itemCountDiv.style.fontSize = "20px";
  itemCountDiv.innerText = `${totalItems} Items`;
  subtotalContainer.appendChild(itemCountDiv);

  // Subtotal
  const sub = document.createElement("div");
  sub.className = "subtotal-box";
  sub.innerText = "Subtotal: $" + subtotal.toFixed(2);
  subtotalContainer.appendChild(sub);

  os.appendChild(subtotalContainer);
}


 
function removeItem(index){
  order[index].qty--;
  if(order[index].qty<=0) order.splice(index,1);
  openOrderScreen();
  updateHeaderTotals();
}

function goHome(){switchScreen("screen1");}

function showQR() {
  const overlay = document.getElementById("overlay");
  const qrcodeDiv = document.getElementById("qrcode");

  overlay.style.display = "flex";
  qrcodeDiv.innerHTML = "";

  const text = order.map(i => `${i.name} x ${i.qty}`).join("\n") || "No items";

  // Determine max size that fits screen
  const maxSize = Math.min(window.innerWidth * 0.8, window.innerHeight * 0.8); 
  new QRCode(qrcodeDiv, { text: text, width: maxSize, height: maxSize ,correctLevel: QRCode.CorrectLevel.L});
}



function closeQR() {
  const overlay = document.getElementById("overlay");
  overlay.style.display = "none";

  // Clear the view order screen
  const orderScreen = document.getElementById("orderScreen");
  orderScreen.innerHTML = "";

  // Reset header totals if desired
  itemCount.innerText = "0 items";
  totalAmount.innerText = "$0.00";

  // Optional: reset the current order array if you want to fully clear it
  order = [];
  goHome();
}

</script>

</body>
</html>

